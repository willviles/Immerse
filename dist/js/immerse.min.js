!function($,window,document,undefined){var Immerse=function(){};Immerse.prototype={setup:function(setup){return this.defaults={options:{namespace:"imm",breakpoints:{mobile:480,tablet:768,mdDesktop:992,lgDesktop:1200},muteButton:{unmuted:"Audio On",muted:"Audio Off"}},sections:[]},this.setup=$.extend(!0,this.defaults,setup),this},init:function(elem){this.elem=elem,this.$elem=$(elem),this._assets=this.setup.assets,this._sections=[],this._isScrolling=!1,this._canScroll=!0,this._allAudio=[];return $.Immerse.viewportController.init(this),this._assetQueue=$.Immerse.assetController.register(this),$.Immerse.sectionController.init(this),$.Immerse.scrollController.init(this),$.Immerse.navigationController.init(this),$.Immerse.audioController.init(this),$.Immerse.assetController.loading(this),this},utils:{stringify:function(str){return str.replace(/[-_]/g," ").replace(/([a-z])([A-Z])/g,"$1 $2").toLowerCase().replace(/\b[a-z]/g,function(letter){return letter.toUpperCase()})},namespacify:function(){for(var namespacedString=this.setup.options.namespace,i=0;i<arguments.length;++i)namespacedString+="-"+arguments[i];return namespacedString},datatagify:function(str,val){return val===undefined?"[data-"+str+"]":"[data-"+str+'="'+val+'"]'},cookies:{set:function(name,value,expiresInSeconds){var r=new Date;r.setTime(r.getTime()+24*expiresInSeconds*60*60*1e3);var i="expires="+r.toGMTString();document.cookie=name+"="+value+"; "+i},get:function(e){for(var t=e+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1);if(-1!=i.indexOf(t))return i.substring(t.length,i.length)}return""},"delete":function(e){this.utils.cookies.set.call(this,e,"",-1)}}},section:function(section){return $.Immerse.sectionController.add(this,section)},audio:function(status){return status===undefined?this._muted?!1:!0:void $.Immerse.audioController.changeStatus(this,status)},changeSection:function(goVar){return goVar===undefined?!1:void $.Immerse.scrollController.doScroll(this,$target)}},$.Immerse={setup:function(setup){return new Immerse(this).setup(setup)},registerComponent:function(opts){$.Immerse.componentController.add(opts)}}}(jQuery,window,document),function($,window,document,undefined){var ImmerseSectionController=function(){};ImmerseSectionController.prototype={sectionDefaults:{animations:{},actions:{},attributes:{},components:{},options:{hideFromNav:!1,unbindScroll:!1}},add:function(imm,section){this.imm=imm;var defaults=this.sectionDefaults;return defaults=$.Immerse.componentController.extendDefaults(defaults),defaults=$.Immerse.componentController.extendGlobalOptions(this.imm,defaults),defaults=$.Immerse.audioController.extendGlobalOptions(this.imm,defaults),this.sectionDefaults=defaults,section=$.extend({},defaults,section),this.imm.setup.sections.push(section),section},init:function(imm){this.imm=imm;var sectionSelector=this.imm.utils.namespacify.call(this.imm,"section"),$allSectionElems=$("."+sectionSelector),sectionDefaults=this.sectionDefaults,fullscreenClass=this.imm.utils.namespacify.call(this.imm,"fullscreen"),that=this;return $.each($allSectionElems,function(i,$s){var generatedSection=sectionDefaults,n=that.imm.utils.stringify($($s)[0].id),u=$($s).hasClass(fullscreenClass)?!1:!0,newVals={element:$($s),name:n,options:{unbindScroll:u}};generatedSection=$.extend({},generatedSection,newVals),that.imm._sections.push(generatedSection)}),$.each(this.imm.setup.sections,function(i,s){var $s=$(s.element);$.each(that.imm._sections,function(i,_s){that.imm._sections[i]=$(_s.element)[0]===$(s.element)[0]?s:_s}),$.each(s.animations,function(name,animation){that.register.animations.call(that,$s,name,animation)}),$.each(s.actions,function(name,action){that.register.actions.call(that,$s,name,action)}),$.each(s.attributes,function(name,attr){that.register.attributes.call(that,$s,name,attr)})}),$.Immerse.scrollController.updateSectionOffsets(this.imm),this.imm._sections.sort(function(obj1,obj2){return obj1.scrollOffset-obj2.scrollOffset}),$.each(this.imm._sections,function(n,s){$.Immerse.componentController.init(that,s)}),this},register:{animations:function(s,n,a){if($.Immerse.viewportController.isView(this.imm,a)===!1)return!1;var runtimeStr,resetStr,t=new TimelineMax({paused:!0}),c=a.timeline(s),d=isNaN(a.delay)?null:a.delay;null!==d&&t.set({},{},"+="+d),t.add(c),$.each(a.runtime,function(i,r){runtimeStr=runtimeStr+" "+r}),$.each(a.reset,function(i,r){resetStr=resetStr+" "+r}),s.on(runtimeStr,function(){console.log("Running "+n),t.play()}),s.on(resetStr,function(){console.log("Resetting "+n),t.pause(0,!0)})},actions:function(s,n,a){if($.Immerse.viewportController.isView(this.imm,a)===!1)return!1;var runtimeStr,action=a.action,d=isNaN(a.delay)?0:a.delay,that=this;$.each(a.runtime,function(i,r){runtimeStr=runtimeStr+" "+r}),s.on(runtimeStr,function(){setTimeout(function(){action.call(that,s)},d)})},attributes:function(s,n,a){if($.Immerse.viewportController.isView(this.imm,a)===!1)return!1;var runtimeStr,value=a.value,d=isNaN(a.delay)?0:a.delay,that=this;$.each(a.runtime,function(i,r){runtimeStr=runtimeStr+" "+r}),s.on(runtimeStr,function(){setTimeout(function(){that.imm.$elem.trigger(n,value)},d)})}}},$.Immerse.sectionController={init:function(imm){return new ImmerseSectionController(this).init(imm)},add:function(imm,section){return new ImmerseSectionController(this).add(imm,section)}}}(jQuery,window,document),function($,window,document,undefined){var ImmerseScrollController=function(){};ImmerseScrollController.prototype={init:function(imm){var that=this;return this.imm=imm,this.imm._scrollContainer=$($(this.imm.elem)[0]===$("body")[0]?window:this.imm.elem),this.imm._currentSection=this.imm._sections[0],this.imm._sectionBelow=this.imm._sections[1],this.imm._scrollContainer.scrollTop(0),this.imm._scrollUnbound=this.imm._currentSection.options.unbindScroll?!0:!1,this.imm.$elem.on("immInit sectionChanged",function(e,d){"sectionChanged"===e.type&&(that.imm._scrollUnbound=d.current.options.unbindScroll?!0:!1),$.each(that.events,function(n,f){f.call(that)})}),this},events:{scroll:function(){this.imm._scrollContainer.off("mousewheel wheel DOMMouseScroll").on("mousewheel wheel DOMMouseScroll",this.handlers.scroll.detect.bind(this))},keys:function(){$(document).off("keydown keyup"),$(document).on("keydown",this.handlers.keys.down.bind(this)),$(document).on("keyup",this.handlers.keys.up.bind(this))},touch:function(){return this.imm._isDesktop?!1:($(document).off("touchstart touchmove touchend"),this.imm._scrollUnbound?$(document).on("touchmove",this.unbound.bind(this)):$(document).on("touchstart",this.handlers.touch.start.bind(this)),void $(document).off("swipedown swipeup").on("swipedown swipeup",this.handlers.touch.detect.bind(this)))}},handlers:{scroll:{detect:function(e){return this.imm._canScroll?void(this.imm._scrollUnbound?(this.handlers.scroll.toggle("enable",e),this.unbound.call(this,e)):(this.handlers.scroll.toggle("disable",e),e.originalEvent.wheelDelta>=0?this.ifCanThenGo.call(this,this.imm,"UP"):this.ifCanThenGo.call(this,this.imm,"DOWN"))):!1},toggle:function(status,e){function preventDefaultScroll(e){e=e||window.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}"enable"===status?(window.removeEventListener&&window.removeEventListener("DOMMouseScroll",preventDefaultScroll,!1),window.onmousewheel=document.onmousewheel=null,window.onwheel=null,window.ontouchmove=null):"disable"===status&&(window.addEventListener&&window.addEventListener("DOMMouseScroll",preventDefaultScroll,!1),window.onwheel=preventDefaultScroll,window.onmousewheel=document.onmousewheel=preventDefaultScroll,window.ontouchmove=preventDefaultScroll)}},keys:{down:function(e){if(!this.imm._scrollUnbound&&this.imm._lastKey&&this.imm._lastKey.which==e.which)return void e.preventDefault();switch(this.imm._lastKey=e,e.which){case 38:this.imm._scrollUnbound?this.unbound.call(this,e):(e.preventDefault(),this.ifCanThenGo.call(this,this.imm,"UP"));break;case 40:this.imm._scrollUnbound?this.unbound.call(this,e):(e.preventDefault(),this.ifCanThenGo.call(this,this.imm,"DOWN"));break;default:return}},up:function(e){this.imm._lastKey=null}},touch:{start:function(e){var data=e.originalEvent.touches?e.originalEvent.touches[0]:e;this.imm._touchStartData={time:(new Date).getTime(),coords:[data.pageX,data.pageY]},$(document).on("touchmove",this.handlers.touch.move.bind(this)).one("touchend",this.handlers.touch.end.bind(this))},move:function(e){if(this.imm._touchStartData){var data=e.originalEvent.touches?e.originalEvent.touches[0]:e;this.imm._touchStopData={time:(new Date).getTime(),coords:[data.pageX,data.pageY]},Math.abs(this.imm._touchStartData.coords[1]-this.imm._touchStopData.coords[1])>10&&e.preventDefault()}},end:function(e){if($(document).off("touchmove",this.handlers.touch.move),this.imm._touchStartData&&this.imm._touchStopData&&this.imm._touchStopData.time-this.imm._touchStartData.time<1e3&&Math.abs(this.imm._touchStartData.coords[1]-this.imm._touchStopData.coords[1])>30&&Math.abs(this.imm._touchStartData.coords[0]-this.imm._touchStopData.coords[0])<75){var direction=this.imm._touchStartData.coords[1]>this.imm._touchStopData.coords[1]?"swipeup":"swipedown";$(document).trigger(direction)}this.imm._touchStartData=this.imm._touchStopData=undefined},detect:function(e){if(this.imm._scrollUnbound)return!1;switch(e.type){case"swipedown":this.ifCanThenGo.call(this,this.imm,"UP");break;case"swipeup":this.ifCanThenGo.call(this,this.imm,"DOWN");break;default:return}}}},ifCanThenGo:function(imm,goVar){this.imm=this.imm===undefined?imm:this.imm,this.imm._isScrolling===!1&&this.imm._canScroll===!0&&this.imm._htmlScrollLocked!==!0&&(this.imm._isScrolling=!0,this.go.fire.call(this,goVar))},go:{prepare:function(o){var a={currentSection:this.imm._currentSection};return a.$currentSection=$(a.currentSection.element),a.currentSectionIndex=this.imm._sections.indexOf(a.currentSection),o.jquery?(a.nextSection=$.grep(this.imm._sections,function(s){return o[0].id==s.element[0].id})[0],a.direction=a.currentSection.scrollOffset>a.nextSection.scrollOffset?"UP":"DOWN"):("UP"===o||"DOWN"===o)&&(a.direction=o,a.nextSection="UP"===a.direction?this.imm._sections[a.currentSectionIndex-1]:this.imm._sections[a.currentSectionIndex+1]),"UP"===a.direction?a.triggers={exiting:"exitingUp",entering:"enteringUp",exited:"exitedUp",entered:"enteredUp"}:"DOWN"===a.direction&&(a.triggers={exiting:"exitingDown",entering:"enteringDown",exited:"exitedDown",entered:"enteredDown"}),a.nextSection===undefined?!1:(a.$nextSection=$(a.nextSection.element),a.nextSectionIndex=this.imm._sections.indexOf(a.nextSection),this.imm._sectionAbove=this.imm._sections[a.nextSectionIndex-1],this.imm._sectionBelow=this.imm._sections[a.nextSectionIndex+1],a)},fire:function(o){var opts=this.go.prepare.call(this,o);return opts===!1?(this.imm._isScrolling=!1,this.imm._canScroll=!0,!1):void(opts.nextSection.options.unbindScroll?opts.currentSection.options.unbindScroll?this.go.change.call(this,opts):"UP"===opts.direction?this.go.change.call(this,opts):"DOWN"===opts.direction&&this.go.animate.call(this,opts):this.go.animate.call(this,opts))},animate:function(opts){var dist=opts.nextSection.scrollOffset,that=this;opts.$currentSection.trigger(opts.triggers.exiting),opts.$nextSection.trigger(opts.triggers.entering),this.imm.$elem.animate({scrollTop:dist},1e3,function(){opts.$nextSection.trigger(opts.triggers.entered),opts.$currentSection.trigger(opts.triggers.exited),that.imm._lastSection=opts.currentSection,that.imm._currentSection=opts.nextSection,that.imm.$elem.trigger("sectionChanged",[{last:that.imm._lastSection,current:that.imm._currentSection,below:that.imm._sectionBelow,above:that.imm._sectionAbove}]),setTimeout(function(){that.imm._isScrolling=!1,that.imm._canScroll=!0},500)})},change:function(opts){var that=this;opts.$currentSection.trigger(opts.triggers.exiting),opts.$nextSection.trigger(opts.triggers.entering),opts.$nextSection.trigger(opts.triggers.entered),this.imm._lastSection=opts.currentSection,this.imm._currentSection=opts.nextSection,this.imm.$elem.trigger("sectionChanged",[{last:that.imm._lastSection,current:that.imm._currentSection,below:that.imm._sectionBelow,above:that.imm._sectionAbove}]),this.imm._isScrolling=!1,this.imm._canScroll=!0}},unbound:function(e){var isAbove=this.imm._isTouch?this.imm._scrollContainer.scrollTop()<this.imm._currentSection.scrollOffset:this.imm._scrollContainer.scrollTop()<=this.imm._currentSection.scrollOffset,belowVal=this.imm._sectionBelow.options.unbindScroll===!1?this.imm._sectionBelow.scrollOffset-this.imm._windowHeight:this.imm._sectionBelow.scrollOffset,isBelow=this.imm._isTouch?this.imm._scrollContainer.scrollTop()>belowVal:this.imm._scrollContainer.scrollTop()>=belowVal;if(isAbove){if(this.utils.isScrollEvent(e)&&e.originalEvent.wheelDelta<0)return;if(this.utils.isKeydownEvent(e)&&38!==e.which)return;this.imm._sectionAbove.options.unbindScroll?this.ifCanThenGo.call(this,this.imm,"UP"):(e.preventDefault(),this.imm._scrollUnbound=!1,this.ifCanThenGo.call(this,this.imm,"UP"))}else if(isBelow){if(this.utils.isScrollEvent(e)&&e.originalEvent.wheelDelta>=0)return;if(this.utils.isKeydownEvent(e)&&40!==e.which)return;this.imm._sectionBelow.options.unbindScroll?this.ifCanThenGo.call(this,this.imm,"DOWN"):(e.preventDefault(),this.imm._scrollUnbound=!1,this.ifCanThenGo.call(this,this.imm,"DOWN"))}},sectionOffset:{set:function(s){s.scrollOffset=$(s.element).offset().top},update:function(imm){this.imm=this.imm===undefined?imm:this.imm;var that=this;$.each(this.imm._sections,function(i,s){that.sectionOffset.set.call(that,s)})}},stick:function(imm){if(this.imm=this.imm===undefined?imm:this.imm,!this.imm._scrollUnbound){var t=this.imm._currentSection.scrollOffset;this.imm._scrollContainer.scrollTop(t)}},utils:{isScrollEvent:function(e){return"wheel"===e.type||"DOMMouseScroll"===e.type||"mousewheel"===e.type},isKeydownEvent:function(e){return"keydown"===e.type}},htmlScroll:function(imm,status){this.imm=this.imm===undefined?imm:this.imm,"lock"===status?($("html").css("overflow","hidden"),this.imm._htmlScrollLocked=!0):($("html").css("overflow","scroll"),this.imm._htmlScrollLocked=!1)}},$.Immerse.scrollController={init:function(imm){return new ImmerseScrollController(this).init(imm)},doScroll:function(imm,goVar){var controller=new ImmerseScrollController(this);return controller.ifCanThenGo.call(controller,imm,goVar),controller},updateSectionOffsets:function(imm){var controller=new ImmerseScrollController(this);return controller.sectionOffset.update.call(controller,imm),controller},stickSection:function(imm){var controller=new ImmerseScrollController(this);return controller.stick.call(controller,imm),controller},htmlScroll:function(imm,status){return new ImmerseScrollController(this).htmlScroll(imm,status)}}}(jQuery,window,document),function($,window,document,undefined){var ImmerseAudioController=function(){};ImmerseAudioController.prototype={extendGlobalOptions:function(imm,defaults){var audioSetupOpts=imm.setup.audio;return audioSetupOpts!==undefined&&(defaults.audio=audioSetupOpts),defaults},init:function(imm){this.imm=imm,this.imm._audioPlaying=[];var that=this;return this.muteBtns.init.call(this),this.handleChange.call(this,this,this.imm._currentSection.audio),this.imm.$elem.on("sectionChanged",function(e,d){that.handleChange.call(that,that,d.current.audio)}),this.handleBlurFocus.call(this),this},handleChange:function(that,audioObj){if(this.imm._muted)return!1;this.imm._audioPlaying=[],this.start.call(this,audioObj);var audioToMute=this.imm._allAudio.filter(function(a){return-1===$.inArray(a,that.imm._audioPlaying)});this.mute.call(this,audioToMute)},start:function(audioObj){var that=this;audioObj!==undefined&&$.each(audioObj,function(name,o){var $a=$("audio#"+name),d=isNaN(o.delay)?0:o.delay;that.imm._audioPlaying.push(name),$a[0].paused&&($a[0].volume=0,$a[0].play()),TweenMax.to($a,o.changeDuration,{volume:o.volume,ease:Linear.easeNone,delay:d})})},mute:function(audioToMute){$.each(audioToMute,function(i,name){var $a=$("audio#"+name);TweenMax.to($a,1,{volume:0,ease:Linear.easeNone,onComplete:function(){$a[0].pause(),$a[0].currentTime=0}})})},muteBtns:{init:function(){var muteClass=this.imm.utils.namespacify.call(this.imm,"mute"),that=this;this.imm._$muteBtns=this.imm.$elem.find("."+muteClass),"muted"===this.imm.utils.cookies.get("immAudioState")?this.muteBtns.change.call(this,"off"):this.muteBtns.change.call(this,"on"),this.imm._$muteBtns.on("click",function(){that.muteBtns.click.call(that)})},change:function(state){var s,mutedClass=this.imm.utils.namespacify.call(this.imm,"muted");"off"===state?(s=this.imm.setup.options.muteButton.muted,this.imm._$muteBtns.addClass(mutedClass).html(s),this.imm._muted=!0):(s=this.imm.setup.options.muteButton.unmuted,this.imm._$muteBtns.removeClass(mutedClass).html(s),this.imm._muted=!1)},muteAll:function(imm){this.imm=this.imm===undefined?imm:this.imm;var audioToMute=this.imm._audioPlaying;this.mute.call(this,audioToMute),this.muteBtns.change.call(this,"off"),this.imm.utils.cookies.set.call(this,"immAudioState","muted",3650)},unmuteAll:function(imm){this.imm=this.imm===undefined?imm:this.imm;var currentAudio=this.imm._currentSection.audio;this.start.call(this,currentAudio),this.muteBtns.change.call(this,"on"),this.imm.utils.cookies.set.call(this,"immAudioState","",3650)},click:function(){this.imm._muted?this.muteBtns.unmuteAll.call(this):this.muteBtns.muteAll.call(this)}},handleBlurFocus:function(){var that=this;$(window).on("blur",function(){var audioToMute=that.imm._audioPlaying;that.imm._muted||that.mute.call(that,audioToMute)}),$(window).on("focus",function(){var currentAudio=that.imm._currentSection.audio;that.imm._muted||that.start.call(that,currentAudio)})}},$.Immerse.audioController={init:function(imm){return new ImmerseAudioController(this).init(imm)},extendGlobalOptions:function(imm,defaults){return new ImmerseAudioController(this).extendGlobalOptions(imm,defaults)},changeStatus:function(imm,status){var controller=new ImmerseAudioController(this);return"unmute"===status?controller.muteBtns.unmuteAll.call(controller,imm):"mute"===status&&controller.muteBtns.muteAll.call(controller,imm),controller}}}(jQuery,window,document),function($,window,document,undefined){var ImmerseNavigationController=function(){};ImmerseNavigationController.prototype={init:function(imm){this.imm=imm,this.navListClass=this.imm.utils.namespacify.call(this.imm,"nav-list"),this.navLinkClass=this.imm.utils.namespacify.call(this.imm,"nav-link"),this.sectionDataTag=this.imm.utils.namespacify.call(this.imm,"section");this.addToDOM.call(this);var navItem=$("."+this.navListClass+" li a[data-"+this.sectionDataTag+'="#'+this.imm._currentSection.element[0].id+'"]');this.update.call(this,navItem),this.handleClick.call(this),this.sectionChange.call(this)},handleClick:function(){var that=this;$("."+this.navListClass+" li a","body").on("click",function(){var $target=$($(this).data(that.sectionDataTag));$.Immerse.scrollController.doScroll(that.imm,$target)})},sectionChange:function(){var that=this;this.imm.$elem.on("sectionChanged",function(e,d){var navItem=$("."+that.navListClass+" li a[data-"+that.sectionDataTag+'="#'+d.current.element[0].id+'"]');that.update.call(that,navItem)})},addToDOM:function(){var nav=$("."+this.navListClass);if(0===nav.length)return!1;var str="",that=this;$.each(this.imm._sections,function(i,s){s.options.hideFromNav||(str=str+'<li><a class="'+that.navLinkClass+'" data-'+that.sectionDataTag+'="#'+s.element[0].id+'"><span>'+s.name+"</span></a></li>")}),nav.html(str)},update:function($e){$("."+this.navListClass+" li a").removeClass("current"),$e.length>0&&$e.addClass("current")}},$.Immerse.navigationController={init:function(imm){return new ImmerseNavigationController(this).init(imm)}}}(jQuery,window,document),function($,window,document,undefined){var ImmerseAssetController=function(){};ImmerseAssetController.prototype={register:function(imm){this.imm=imm;var assetLoadingFailed,assetQueueLoaded=jQuery.Deferred(),assetQueue=[],assetQueueCheck=function(){0===assetQueue.length&&(assetQueueLoaded.resolve("loaded"),clearTimeout(assetLoadingFailed))};return that=this,$.each(this.imm._assets,function(n,a){if("audio"===a.type&&that.addToDOM.audio.call(that,n,a),"video"===a.type&&that.addToDOM.video.call(that,n,a),a.wait===!0){if(that.imm._isTouch&&("video"===a.type||"audio"===a.type))return;if(a.error)return void console.log("Asset Failure: Could not preload "+a.type+" asset '"+n+"'");assetQueue.push({name:n,asset:a})}}),$.each(assetQueue,function(i,a){var n=a.name,a=a.asset;if("audio"===a.type||"video"===a.type){if(that.imm._isTouch)return;$(a.type+"#"+n)[0].addEventListener("canplaythrough",function(){assetQueue.splice($.inArray(a,assetQueue),1),assetQueueCheck()},!1)}if("image"===a.type){var fileTypes=$.isArray(a.fileTypes)?a.fileTypes:["jpg"],imagesLoadComplete=jQuery.Deferred(),imagesLoadCheck=function(){0===fileTypes.length&&imagesLoadComplete.resolve("loaded")};$.each(fileTypes,function(i,ft){var tmp=new Image;tmp.src=a.path+"."+ft,tmp.onload=function(){fileTypes.splice($.inArray(ft,fileTypes),1),imagesLoadCheck()}}),imagesLoadComplete.done(function(){assetQueue.splice($.inArray(a,assetQueue),1),assetQueueCheck()})}}),assetQueueCheck(),assetLoadingFailed=setTimeout(function(){assetQueueLoaded.reject("problem")},1e4),assetQueueLoaded.promise()},addToDOM:{audio:function(n,a){if(a.path===undefined)return console.log("Asset Error: Must define a path for audio asset '"+n+"'"),a.error=!0,!1;var l=1==a.loop?"loop":"",fileTypes=$.isArray(a.fileTypes)?a.fileTypes:["mp3"],audioClass=this.imm.utils.namespacify.call(this.imm,"audio"),sourceStr="";return $.each(fileTypes,function(i,ft){sourceStr=sourceStr+'<source src="'+a.path+"."+ft+'" type="audio/'+ft+'">'}),this.imm.$elem.append('<audio id="'+n+'" class="'+audioClass+'" '+l+">"+sourceStr+"</audio>"),this.imm._allAudio.push(n),!0},video:function(n,o){if(o.path===undefined)return console.log("Asset Error: Must define a path for video asset '"+n+"'"),o.error=!0,!1;var videoDataTag=this.imm.utils.namespacify.call(this.imm,"video"),$wrapper=this.imm.$elem.find("[data-"+videoDataTag+'="'+n+'"]'),fileTypes=$.isArray(o.fileTypes)?o.fileTypes:["mp4","ogv","webm"],loop=o.loop===!1?"":'loop="loop" ',sourceStr="";if($wrapper.css("background-image","url("+o.path+".jpg)"),this._isTouch)return!1;$.each(fileTypes,function(i,ft){sourceStr=sourceStr+'<source src="'+o.path+"."+ft+'" type="video/'+ft+'">'});var $v=$("<video "+loop+">"+sourceStr+"</video>");$wrapper.append($v)}},loading:function(imm){this.imm=imm;var loadingOverlayClass=this.imm.utils.namespacify.call(this.imm,"loading");$.when(this.imm._assetQueue).then(function(s){$.each(that.imm._sections,function(i,s){$(s.element).trigger("init")}),that.imm.$elem.trigger("immInit"),$("."+loadingOverlayClass).hide()},function(s){alert("Asset loading failed")})}},$.Immerse.assetController={register:function(imm){return new ImmerseAssetController(this).register(imm)},loading:function(imm){return new ImmerseAssetController(this).loading(imm)}}}(jQuery,window,document),function($,window,document,undefined){var ImmerseViewportController=function(){};ImmerseViewportController.prototype={init:function(imm){return this.imm=imm,this.imm._windowWidth=$(window).width(),this.imm._windowHeight=$(window).height(),this.imm.setup.options.breakpoints=this.prepareBreakpoints.call(this),this.detectDevice.call(this),this.set.call(this,this.imm._windowWidth),this.resize.call(this),this},prepareBreakpoints:function(){var breakpoints=this.imm.setup.options.breakpoints,breakpointArray=[];return $.each(breakpoints,function(name,width){var niceName=name.charAt(0).toUpperCase()+name.slice(1),obj={name:name,niceName:niceName,width:width};breakpointArray.push(obj)}),breakpointArray.sort(function(a,b){return a.width-b.width})},detectDevice:function(){"ontouchstart"in window||"onmsgesturechange"in window?(this.imm._device="touch",this.imm._isTouch=!0,this.imm._isDesktop=!1):(this.imm._device="desktop",this.imm._isTouch=!1,this.imm._isDesktop=!0)},set:function(width){var breakpoints=this.imm.setup.options.breakpoints,currentBreakpoint=this.imm._breakpoint,prevBreak=0,that=this,newBreakpoint=breakpoints[breakpoints.length-1].name;$.each(breakpoints,function(i,obj){that.imm["_is"+obj.niceName]=!1,width>prevBreak&&width<=obj.width&&(newBreakpoint=obj.name,that.imm["_is"+obj.niceName]=!0),prevBreak=obj.width}),currentBreakpoint!==newBreakpoint&&(this.imm._breakpoint=newBreakpoint)},resize:function(){var that=this;$(window).on("resize",function(){that.imm._windowWidth=$(window).width(),that.imm._windowHeight=$(window).height(),that.set.call(that,that.imm._windowWidth),$.Immerse.scrollController.updateSectionOffsets(that.imm),$.Immerse.scrollController.stickSection(that.imm),$.Immerse.componentController.resize(that.imm)})},isView:function(imm,a){if(this.imm=imm,a.devices===undefined&&(a.devices=["touch","desktop"]),a.breakpoints===undefined){var allBreakpoints=[];$.each(this.imm.setup.options.breakpoints,function(i,obj){allBreakpoints.push(obj.name)}),a.breakpoints=allBreakpoints}return-1===$.inArray(this.imm._device,a.devices)?!1:-1===$.inArray(this.imm._breakpoint,a.breakpoints)?!1:void 0}},$.Immerse.viewportController={init:function(imm){return new ImmerseViewportController(this).init(imm)},isView:function(imm,a){return new ImmerseViewportController(this).isView(imm,a)}}}(jQuery,window,document),function($,window,document,undefined){$.Immerse.componentRegistry={};var ImmerseComponentController=function(){};ImmerseComponentController.prototype={add:function(opts){var name=opts.name;return $.Immerse.componentRegistry[name]=opts,this},extendDefaults:function(defaults){return $.each($.Immerse.componentRegistry,function(name,component){component.hasOwnProperty("hasSectionObject")&&component.hasSectionObject===!0&&(defaults.components[name]={}),component.hasOwnProperty("defaults")&&(defaults.components[name]=component.defaults)}),defaults},extendGlobalOptions:function(imm,defaults){var componentSetupOpts=imm.setup.components;return componentSetupOpts!==undefined&&$.each($.Immerse.componentRegistry,function(name,component){componentSetupOpts.hasOwnProperty(name)&&(defaults.components[name]=componentSetupOpts[name])}),defaults},init:function(imm,section){$.each($.Immerse.componentRegistry,function(name,component){var opts={immerse:imm.imm,section:section};component.init(opts)})},resize:function(imm){return imm._isTouch?!1:void $.each($.Immerse.componentRegistry,function(name,component){component.hasOwnProperty("onResize")&&component.onResize(imm)})}},$.Immerse.componentController={add:function(opts){return new ImmerseComponentController(this).add(opts)},extendDefaults:function(defaults){return new ImmerseComponentController(this).extendDefaults(defaults)},extendGlobalOptions:function(imm,defaults){return new ImmerseComponentController(this).extendGlobalOptions(imm,defaults)},init:function(imm,section){return new ImmerseComponentController(this).init(imm,section)},resize:function(imm){return new ImmerseComponentController(this).resize(imm)}}}(jQuery,window,document),$.Immerse.registerComponent({name:"modals",hasSectionObject:!0,init:function(opts){this.imm=opts.immerse,this.modalWrapper=this.imm.utils.namespacify.call(this.imm,"modal-wrapper"),this.modalId=this.imm.utils.namespacify.call(this.imm,"modal-id"),this.modalIdDataTag=this.imm.utils.datatagify.call(this.imm,this.modalId),this.modalOpen=this.imm.utils.namespacify.call(this.imm,"modal-open"),this.modalOpenDataTag=this.imm.utils.datatagify.call(this.imm,this.modalOpen),this.modalAction=this.imm.utils.namespacify.call(this.imm,"modal-action"),this.pluginName=this.name;var section=opts.section,$section=$(section.element),that=this;$.each($section.find(this.modalIdDataTag),function(i,modal){that.prepare.call(that,modal,section)}),$section.find(this.modalOpenDataTag).on("click",function(i,modalBtn){var modalId=$(this).data(that.modalOpen);that.actions.open.call(that,modalId)});var allActions=["close","cancel","confirm","wrapperClick"],allButtons=[];return $.each(allActions,function(i,name){var niceName=name.charAt(0).toUpperCase()+name.slice(1);that["modal"+niceName+"DataTag"]=that.imm.utils.datatagify.call(that.imm,that.modalAction,name),allButtons.push(that["modal"+niceName+"DataTag"])}),$section.find(allButtons.toString()).on("click",function(e){that.handleBtnClick.call(that,e,this,section)}),this},prepare:function(modal,section){var userSettings,extendedSettings,id=$(modal).data(this.modalId),niceId=$.camelCase(id),modalDefaults={element:$(this),onConfirm:"close",onCancel:"close",onClose:"close",onEscape:"close",onWrapperClick:"close"};section.components[this.pluginName].hasOwnProperty(niceId)?(userSettings=section.components[this.pluginName][niceId],extendedSettings=$.extend({},modalDefaults,userSettings),section.components[this.pluginName][niceId]=extendedSettings):section.components[this.pluginName][niceId]=modalDefaults,this.wrap.call(this,modal,id),$(modal).attr("tabindex",0)},wrap:function(modal,id){$wrapper=$('<div class="'+this.modalWrapper+'" data-'+this.modalAction+'="wrapperClick"></div>'),$(modal).wrap($wrapper)},handleBtnClick:function(e,button,section){var action=$(button).data(this.modalAction);if("wrapperClick"!==action||e.target==button){var actionNiceName=action.charAt(0).toUpperCase()+action.slice(1),modal="wrapperClick"===action?$(button).find(this.modalIdDataTag):$(button).closest(this.modalIdDataTag),id=modal.data(this.modalId),niceId=$.camelCase(id);$(section.components.modals[niceId].element).trigger(action);var actionObj=section.components[this.pluginName][niceId]["on"+actionNiceName];"close"===actionObj?this.actions.close.call(this,modal,id):$.isFunction(actionObj)&&actionObj(modal)}},actions:{open:function(id){var $modal=$(this.imm.utils.datatagify.call(this.imm,this.modalId,id));$modal.closest("."+this.modalWrapper).addClass("opened"),$.Immerse.scrollController.htmlScroll(this.imm,"lock"),$modal.focus()},close:function(modal,id){var $modal=$(this.imm.utils.datatagify.call(this.imm,this.modalId,id));$modal.closest("."+this.modalWrapper).removeClass("opened");$.Immerse.scrollController.htmlScroll(this.imm,"unlock"),this.imm._scrollContainer.focus(),$modal.scrollTop(0)}}}),$.Immerse.registerComponent({name:"sliders",init:function(opts){var section=opts.section;$(section.element);return this}}),$.Immerse.registerComponent({name:"stacks",init:function(opts){var section=opts.section;$(section.element);return this},defaults:{option1:!0}}),$.Immerse.registerComponent({name:"tooltips",init:function(opts){this.imm=opts.immerse,this.tooltipClass=this.imm.utils.namespacify.call(this.imm,"tooltip");var section=opts.section,$section=$(section.element),that=this;return $.each($section.find("[data-"+this.tooltipClass+"]"),function(i,tooltip){var $tooltip=$(tooltip),content=$tooltip.data(that.tooltipClass),content="#"===content.charAt(0)?$(content):content,content=content.jquery?$(content).html():content,$content=$('<span class="'+that.tooltipClass+'">'+content+"</span>");$tooltip.append($content),$tooltip.on("mouseover",function(){that.position.call(that,$tooltip,$content)})}),this},position:function($tooltip,$content){$content.removeClass("top left right bottom");var tHeight=$content.height(),tWidth=$content.width(),tXY=$tooltip[0].getBoundingClientRect(),p="top";tHeight>=tXY.top&&(p="bottom"),tWidth/2>=tXY.left?p="right":tWidth/2>=$(window).width()-tXY.right&&(p="left"),$content.addClass(p)}}),$.Immerse.registerComponent({name:"videos",init:function(opts){this.imm=opts.immerse,this.videoDataTag=this.imm.utils.namespacify.call(this.imm,"video");var section=opts.section,$section=$(section.element),that=this,sectionVideos=$section.find("[data-"+this.videoDataTag+"]");return $.each(sectionVideos,function(i,wrapper){that.handler.call(that,opts.immerse,section,wrapper)}),this},handler:function(imm,s,wrapper){if(this.imm=imm,this.imm._isTouch)return!1;
var $wrapper=$(wrapper),$video=$wrapper.find("video"),$s=$(s.element),that=this;return $s.on("init enteringDown enteringUp",function(e){("init"!==e.type||s.element===that.imm._currentSection.element)&&($video.css({visibility:"hidden"}).one("canplaythrough",function(){that.doResize(wrapper)}).one("playing",function(){$video.css("visibility","visible"),$wrapper.css("background-image","none")}),$video[0].paused&&($video[0].play(),that.doResize(wrapper)))}),$s.on("exitedDown exitedUp",function(){$video[0].paused||($video[0].pause(),$video[0].currentTime=0)}),this},onResize:function(imm){var that=this;$.each(imm.$elem.find("[data-"+this.videoDataTag+"]"),function(i,wrapper){that.doResize(wrapper)})},doResize:function(wrapper){var $wrapper=$(wrapper),$video=$wrapper.find("video"),videoHeight=$video[0].videoHeight,videoWidth=$video[0].videoWidth,wrapperHeight=$wrapper.height(),wrapperWidth=$wrapper.width();wrapperWidth/videoWidth>wrapperHeight/videoHeight?$video.css({width:wrapperWidth+2,height:"auto"}):$video.css({width:"auto",height:wrapperHeight+2})},defaults:{value:!0}});
//# sourceMappingURL=immerse.min.js.map