!function($,t,e,i){var n=function(){};n.prototype={setup:function(t){return this.defaults={preload:{},options:{sectionSelector:".imm-section",transition:"default",updateNav:!0,breakpoints:{mobile:480,tablet:768,mdDesktop:992,lgDesktop:1200},muteButton:{unmuted:"Audio On",muted:"Audio Off"}},sections:[]},this.setup=$.extend(!0,this.defaults,t),this},init:function(t,e){this.elem=t,this.$elem=$(t),this.setup=e.setup,this.assets=this.setup.assets,this.sections=[];var i=this;return this.utils.deviceView.init.call(this),this.utils.assets.register.call(this,this),this.controllers.section.call(this,this),this.controllers.scroll.init.call(this,this),this.controllers.navigation.init.call(this,this),this.controllers.audio.init.call(this,this),this},controllers:{section:function(t){var e=$(this.setup.options.sectionSelector);$.each(e,function(e,i){var n={element:$(i),updateNav:t.setup.options.updateNav,transition:t.setup.options.transition,navigation:{hideSection:!1,string:$(i)[0].id}};t.sections.push(n)}),$.each(this.setup.sections,function(e,i){var n=$(i.element);$.each(t.sections,function(e,n){t.sections[e]=$(n.element)[0]===$(i.element)[0]?i:n}),$.each(i.animations,function(e,i){t.controllers.animation.call(t,n,e,i)}),$.each(i.actions,function(e,i){t.controllers.action.call(t,n,e,i)}),$.each(i.attributes,function(e,i){t.controllers.attribute.call(t,n,e,i)})}),$.each(this.sections,function(e,i){t.controllers.scroll.scrollOffset.set.call(t,i),$(i.element).trigger("init")}),this.sections.sort(function(t,e){return t.scrollOffset-e.scrollOffset})},animation:function(t,e,i){if(this.utils.deviceView.check.call(this,i)===!1)return!1;var n=new TimelineMax({paused:!0}),o=i.timeline(t),l=isNaN(i.delay)?null:i.delay,s,r,c=this;null!==l&&n.set({},{},"+="+l),n.add(o),$.each(i.runtime,function(t,e){s=s+" "+e}),$.each(i.reset,function(t,e){r=r+" "+e}),t.on(s,function(){console.log("Running "+e),n.play()}),t.on(r,function(){console.log("Resetting "+e),n.pause(0,!0)})},action:function(t,e,i){if(this.utils.deviceView.check.call(this,i)===!1)return!1;var n=i.action,o=isNaN(i.delay)?0:i.delay,l,s=this;$.each(i.runtime,function(t,e){l=l+" "+e}),t.on(l,function(){setTimeout(function(){n.call(s,t)},o)})},attribute:function(t,e,i){if(this.utils.deviceView.check.call(this,i)===!1)return!1;var n=i.value,o=isNaN(i.delay)?0:i.delay,l,s=this;$.each(i.runtime,function(t,e){l=l+" "+e}),t.on(l,function(){setTimeout(function(){s.$elem.trigger(e,n)},o)})},scroll:{isScrolling:!1,canScroll:!0,init:function(i){this.scrollContainer=$($(this.elem)[0]===$("body")[0]?t:this.elem),this.controllers.scroll.currentSection=this.sections[0],this.scrollContainer.scrollTop(0),this.scrollContainer.bind("mousewheel wheel DOMMouseScroll",function(t){i.controllers.scroll.handler.call(i,t)}),$(e).keydown(function(t){switch(t.which){case 38:if(t.preventDefault(),i.controllers.scroll.isScrolling!==!1&&i.controllers.scroll.canScroll!==!0)return!1;i.controllers.scroll.isScrolling=!0,i.controllers.scroll.go.call(i,"UP");break;case 40:if(t.preventDefault(),i.controllers.scroll.isScrolling!==!1&&i.controllers.scroll.canScroll!==!0)return!1;i.controllers.scroll.isScrolling=!0,i.controllers.scroll.go.call(i,"DOWN");break;default:return}})},scrollOffset:{set:function(t){t.scrollOffset=$(t.element).offset().top},update:function(){var t=this;$.each(this.sections,function(e,i){t.controllers.scroll.scrollOffset.set.call(t,i)})}},stickySection:function(){var t=this.controllers.scroll.currentSection.scrollOffset;this.scrollContainer.scrollTop(t)},status:function(i,n){function o(e){e=e||t.event,e.preventDefault&&e.preventDefault(),e.returnValue=!1}"enable"===i?(t.removeEventListener&&t.removeEventListener("DOMMouseScroll",o,!1),t.onmousewheel=e.onmousewheel=null,t.onwheel=null,t.ontouchmove=null):"disable"===i&&(t.addEventListener&&t.addEventListener("DOMMouseScroll",o,!1),t.onwheel=o,t.onmousewheel=e.onmousewheel=o,t.ontouchmove=o)},handler:function(t){this.controllers.scroll.status("disable",t),this.controllers.scroll.isScrolling===!1&&this.controllers.scroll.canScroll===!0&&(this.controllers.scroll.isScrolling=!0,t.originalEvent.wheelDelta>=0?this.controllers.scroll.go.call(this,"UP"):this.controllers.scroll.go.call(this,"DOWN"))},go:function(t){var e,n,o,l=this.controllers.scroll.currentSection,s=this.sections.indexOf(l),r=$(l.element),c=this;if(t.jquery?(e=$.grep(this.sections,function(e){return t[0].id==e.element[0].id})[0],o=l.scrollOffset>e.scrollOffset?"UP":"DOWN"):("UP"===t||"DOWN"===t)&&(o=t,e="UP"===o?this.sections[s-1]:this.sections[s+1]),"UP"===o?n={exiting:"exitingUp",entering:"enteringUp",exited:"exitedUp",entered:"enteredUp"}:"DOWN"===o&&(n={exiting:"exitingDown",entering:"enteringDown",exited:"exitedDown",entered:"enteredDown"}),e===i)return c.controllers.scroll.isScrolling=!1,c.controllers.scroll.canScroll=!0,!1;var a=$(e.element),u=e.scrollOffset;r.trigger(n.exiting),a.trigger(n.entering),this.$elem.animate({scrollTop:u},1e3,function(){a.trigger(n.entered),r.trigger(n.exited),c.$elem.trigger("sectionChanged",[{prev:l,current:e}]),c.controllers.scroll.currentSection=e,setTimeout(function(){c.controllers.scroll.isScrolling=!1,c.controllers.scroll.canScroll=!0},500)})}},navigation:{init:function(t){this.controllers.navigation.addToDOM.call(this);var e=$('.imm-nav-list li a[data-imm-section="#'+this.controllers.scroll.currentSection.element[0].id+'"]');t.controllers.navigation.update.call(t,e),$(".imm-nav-list li a").on("click",function(){var e=$($(this).data("imm-section"));t.controllers.scroll.go.call(t,e),t.controllers.navigation.update.call(t,$(this))}),this.$elem.on("sectionChanged",function(e,i){var n=$('.imm-nav-list li a[data-imm-section="#'+i.current.element[0].id+'"]');t.controllers.navigation.update.call(t,n)})},addToDOM:function(){var t=$(".imm-nav-list");if(0===t.length)return!1;var e="";$.each(this.sections,function(t,i){return i.navigation.hideSection?!1:void(e=e+'<li>\n                          <a class="imm-nav-link" data-imm-section="#'+i.element[0].id+'">\n                            <span>'+i.navigation.string+"</span>\n                          </a>\n                        </li>")}),t.html(e)},update:function(t){$(".imm-nav-list li a").removeClass("current"),t!==i&&t.addClass("current")}},audio:{all:[],playing:[],muted:!1,init:function(t){this.controllers.audio.muteBtns.init.call(this),this.controllers.audio.handleChange.call(this,this,this.controllers.scroll.currentSection.audio),this.$elem.on("sectionChanged",function(e,i){t.controllers.audio.handleChange.call(t,t,i.current.audio)}),this.controllers.audio.handleBlurFocus.call(this)},handleChange:function(t,e){if(this.controllers.audio.muted)return!1;this.controllers.audio.playing=[],this.controllers.audio.start.call(this,e);var i=this.controllers.audio.all.filter(function(e){return-1===$.inArray(e,t.controllers.audio.playing)});this.controllers.audio.mute.call(this,i)},start:function(t){var e=this;t!==i&&$.each(t,function(t,i){var n=$("audio#"+t),o=isNaN(i.delay)?0:i.delay;e.controllers.audio.playing.push(t),n[0].paused&&(n[0].volume=0,n[0].play()),TweenMax.to(n,i.changeDuration,{volume:i.volume,ease:Linear.easeNone,delay:o})})},mute:function(t){$.each(t,function(t,e){var i=$("audio#"+e);TweenMax.to(i,1,{volume:0,ease:Linear.easeNone,onComplete:function(){i[0].pause(),i[0].currentTime=0}})})},muteBtns:{init:function(){var t=this;this.controllers.audio.$muteBtns=this.$elem.find(".imm-mute"),"muted"===this.utils.cookies.get("immAudioState")?this.controllers.audio.muteBtns.change.call(this,"off"):this.controllers.audio.muteBtns.change.call(this,"on"),this.controllers.audio.$muteBtns.on("click",function(){t.controllers.audio.muteBtns.click.call(t)})},change:function(t){var e;"off"===t?(e=this.setup.options.muteButton.muted,this.controllers.audio.$muteBtns.addClass("imm-muted").html(e),this.controllers.audio.muted=!0):(e=this.setup.options.muteButton.unmuted,this.controllers.audio.$muteBtns.removeClass("imm-muted").html(e),this.controllers.audio.muted=!1)},click:function(){if(this.controllers.audio.muted){var t=this.controllers.scroll.currentSection.audio;this.controllers.audio.start.call(this,t),this.controllers.audio.muteBtns.change.call(this,"on"),this.utils.cookies.set.call(this,"immAudioState","",3650)}else{var e=this.controllers.audio.playing;this.controllers.audio.mute.call(this,e),this.controllers.audio.muteBtns.change.call(this,"off"),this.utils.cookies.set.call(this,"immAudioState","muted",3650)}}},handleBlurFocus:function(){var e=this;$(t).on("blur",function(){var t=e.controllers.audio.playing;e.controllers.audio.muted||e.controllers.audio.mute.call(e,t)}),$(t).on("focus",function(){var t=e.controllers.scroll.currentSection.audio;e.controllers.audio.muted||e.controllers.audio.start.call(e,t)})}}},utils:{deviceView:{init:function(){this.windowWidth=$(t).width(),this.windowHeight=$(t).height(),this.utils.deviceView.set.call(this,this.windowWidth),this.utils.deviceView.resize.call(this,this)},set:function(t){var e=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|OperaMini/i.test(navigator.userAgent),i=480>=t;e||i?(this.device="mobile",this.isMobile=!0,this.isDesktop=!1):(this.device="desktop",this.isMobile=!1,this.isDesktop=!0)},resize:function(e){this.windowWidth=$(t).width(),this.windowHeight=$(t).height(),$(t).on("resize",function(){e.utils.deviceView.set.call(e,e.windowWidth),e.controllers.scroll.scrollOffset.update.call(e),e.controllers.scroll.stickySection.call(e)})},check:function(t){var e=-1!==$.inArray("mobile",t.devices),i=-1!==$.inArray("desktop",t.devices);return e&&!i&&!this.isMobile||i&&!e&&!this.isDesktop?!1:void 0}},cookies:{set:function(t,i,n){var o=new Date;o.setTime(o.getTime()+24*n*60*60*1e3);var l="expires="+o.toGMTString();e.cookie=t+"="+i+"; "+l},get:function(t){for(var i=t+"=",n=e.cookie.split(";"),o=0;o<n.length;o++){for(var l=n[o];" "==l.charAt(0);)l=l.substring(1);if(-1!=l.indexOf(i))return l.substring(i.length,l.length)}return""},"delete":function(t){this.utils.cookies.set.call(this,t,"",-1)}},assets:{register:function(t){$.each(this.assets,function(e,i){"audio"===i.type&&t.utils.assets.addToDOM.audio.call(t,e,i)})},addToDOM:{audio:function(t,e){var i=1==e.loop?"loop":"";return this.$elem.append('<audio id="'+t+'" class="imm-audio" src="'+e.path+'" '+i+"></audio>"),this.controllers.audio.all.push(t),!0}}},extendSection:function(t,e){var i={animations:{},actions:{},attributes:{},updateNav:t.defaults.options.updateNav,transition:t.defaults.options.transition,navigation:{hideSection:!1,string:e.element[0].id}},e=$.extend(!0,i,e);return t.setup.sections.push(e),e}}},$.Immerse={page:{setup:function(t){return new n(this).setup(t)}},section:{setup:function(t,e){return new n(this).utils.extendSection(t,e)}},init:function(t,e){new n(this).init(t,e)}}}(jQuery,window,document);
//# sourceMappingURL=./immerse.min.js.map